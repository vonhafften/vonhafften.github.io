k_star
k_star <- uniroot(temp, c(0,10))
k_star <- uniroot(temp, c(0,4))
k_star <- uniroot(temp, c(0,3))
k_star <- uniroot(temp, c(0,2))
k_star <- uniroot(temp, c(0,1.5))
k_star <- uniroot(temp, c(0,1))
k_star
k_star <- uniroot(temp, c(0,1))$root
b_star <- q_star * k_star / R
b_star
k_star
q_star
f2 <- function(k_0,k_1) {1/R*G_prime(1/m*(K_bar - k_1))-a*k_0/k_1}
f1 <- function(k_1) {1/R*G_prime(1/m*(K_bar - k_1))-a_ss}
a_0 <- c(1.1, 1.1, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0)
a_0 <- c(1.1, 1.1, rep(a_ss, 100))
a_0
k <- a * 0.0 + k_star
for (t in 1:(length(a)-1)) {
f3 <- function(k_1) {f2(a[t],k[t],k_1)}
k[t+1] <- uniroot(f3, c(0,1))$root
}
f2 <- function(a_0,k_0,k_1) {1/R*G_prime(1/m*(K_bar - k_1))-a_0*k_0/k_1}
a <- c(1.1, 1.1, rep(a_ss, 100))
k <- a * 0.0 + k_star
for (t in 1:(length(a)-1)) {
f3 <- function(k_1) {f2(a[t],k[t],k_1)}
k[t+1] <- uniroot(f3, c(0,1))$root
}
k
plot(a)
plot(a)
plot(k)
a <- c(1.1, 1.1, rep(a_ss, 10))
k <- a * 0.0 + k_star
for (t in 1:(length(a)-1)) {
f3 <- function(k_1) {f2(a[t],k[t],k_1)}
k[t+1] <- uniroot(f3, c(0,1))$root
}
plot(a)
plot(k)
a <- c(0.9, 0.9, rep(a_ss, 10))
k <- a * 0.0 + k_star
for (t in 1:(length(a)-1)) {
f3 <- function(k_1) {f2(a[t],k[t],k_1)}
k[t+1] <- uniroot(f3, c(0,1))$root
}
plot(a)
plot(k)
u <- a*k[1:(length(k)-1)]
u <- a[1:(length(k)-1)]*k[1:(length(k)-1)]
u <- a[1:(length(k)-1)]*k[1:(length(k)-1)]/k[2:length(k)]
u
plot(u)
plot(a)
abline(h=k_star)
plot(k)
abline(h=k_star)
u <- a*k/c(k[2:length(k)], k_bar)
plot(u)
u_star <- q_star - q_star / R
abline(h=u_star)
q <- a*0.0
(length(a)-1):1
q <- a*0.0 + q_star
for (t in (length(a)-1):1) {
q[t] = a[t]*k[t]/k[t+1] + q[t+1]/R
}
plot(q)
abline(h=q_star)
theta <- 0.5
q_star = a_ss * R / (R - 1)
q_star
q_star = a_ss * R / (R - theta)
q_star
q_star = a_ss * R / (R - theta)
f1 <- function(k_1) {1/R*G_prime(1/m*(K_bar - k_1))-a_ss}
k_star <- uniroot(f1, c(0,K_bar))$root
b_star <- q_star * k_star / R
u_star <- q_star - q_star / R
u_star
q_star
k_star
library(uniroot)
m <- 1
K_bar <- 1
beta_prime <- 0.95
a_ss <- 1
R <- 1/beta_prime
G_prime <- function(x) {0.5*x^(0.5-1) }
G_prime(0.0)
a_ss*R
G_prime(K_bar/m)
q_star = a_ss * R / (R - 1)
f1 <- function(k_1) {1/R*G_prime(1/m*(K_bar - k_1))-a_ss}
install.packages("uniroot")
plot(a)
library(uniroot)
install.packages("uniroot")
library(uniroot)
install.packages("uniroot")
library(uniroot)
install.packages("uniroot")
library(uniroot)
m <- 1
K_bar <- 1
beta_prime <- 0.95
a_ss <- 1
R <- 1/beta_prime
G_prime <- function(x) {0.5*x^(0.5-1) }
G_prime(0.0)
a_ss*R
G_prime(K_bar/m)
q_star = a_ss * R / (R - 1)
f1 <- function(k_1) {1/R*G_prime(1/m*(K_bar - k_1))-a_ss}
k_star <- uniroot(f1, c(0,K_bar))$root
b_star <- q_star * k_star / R
u_star <- q_star - q_star / R
a <- c(0.9, 0.9, rep(a_ss, 10))
k <- a * 0.0 + k_star
f2 <- function(a_0,k_0,k_1) {1/R*G_prime(1/m*(K_bar - k_1))-a_0*k_0/k_1}
for (t in 1:(length(a)-1)) {
f3 <- function(k_1) {f2(a[t],k[t],k_1)}
k[t+1] <- uniroot(f3, c(0,K_bar))$root
}
plot(a)
plot(k)
plot(k, type="l")
abline(h=k_star)
plot(k, type="l", col = :red, lty=2)
plot(k, type="l", col = "red"", lty=2)
abline(h=k_star)
u <- a*k/c(k[2:length(k)], k_bar)
plot(u)
abline(h=u_star)
q <- a*0.0 + q_star
for (t in (length(a)-1):1) {
q[t] = a[t]*k[t]/k[t+1] + q[t+1]/R
}
plot(q)
abline(h=q_star)
plot(k, type="l", col = "red", lty=2)
plot(k, type="l", col = "red", lty=2)
abline(h=k_star)
plot(u, type="l", col = "red", lty=2)
plot(q, type="l", col = "red", lty=2)
q <- a*0.0 + q_star
for (t in (length(a)-1):1) {
q[t] = a[t]*k[t]/k[t+1] + q[t+1]/R
}
plot(q, type="l", col = "red", lty=2)
abline(h=q_star)
plot(a)
plot(a, type="l", col = "red", lty=2)
plot(k, type="l", col = "red", lty=2)
plot(a, type="l", col = "red", lty=2)
plot(k, type="l", col = "red", lty=2)
abline(h=k_star)
b <- q * k / R
plot(b, type="l", col = "red", lty=2)
abline(h=b_star)
plot(a, type="l", col = "red", lty=2)
plot(k, type="l", col = "red", lty=2)
plot(k, type="l", col = "red", lty=2,ylim=c(0,1))
plot(a, type="l", col = "red", lty=2)
plot(k, type="l", col = "red", lty=2)
plot(a, type="l", col = "red", lty=2)
plot(k, type="l", col = "red", lty=2)
abline(h=k_star)
plot(q, type="l", col = "red", lty=2)
abline(h=q_star)
plot(b, type="l", col = "red", lty=2)
abline(h=b_star)
k_prime <- k_bar - k
m <- 1
K_bar <- 1
beta_prime <- 0.95
a_ss <- 1
R <- 1/beta_prime
G_prime <- function(x) {0.5*x^(0.5-1) }
G_prime(0.0)
a_ss*R
G_prime(K_bar/m)
q_star = a_ss * R / (R - 1)
f1 <- function(k_1) {1/R*G_prime(1/m*(K_bar - k_1))-a_ss}
k_star <- uniroot(f1, c(0,K_bar))$root
b_star <- q_star * k_star / R
u_star <- q_star - q_star / R
a <- c(0.9, 0.9, rep(a_ss, 10))
k <- a * 0.0 + k_star
f2 <- function(a_0,k_0,k_1) {1/R*G_prime(1/m*(K_bar - k_1))-a_0*k_0/k_1}
for (t in 1:(length(a)-1)) {
f3 <- function(k_1) {f2(a[t],k[t],k_1)}
k[t+1] <- uniroot(f3, c(0,K_bar))$root
}
G <- function(x) {x^0.5}
G_prime <- function(x) {0.5*x^(0.5-1) }
G_prime(0.0)
a_ss*R
G_prime(K_bar/m)
q_star = a_ss * R / (R - 1)
f1 <- function(k_1) {1/R*G_prime(1/m*(K_bar - k_1))-a_ss}
k_star <- uniroot(f1, c(0,K_bar))$root
b_star <- q_star * k_star / R
u_star <- q_star - q_star / R
a <- c(0.9, 0.9, rep(a_ss, 10))
k <- a * 0.0 + k_star
f2 <- function(a_0,k_0,k_1) {1/R*G_prime(1/m*(K_bar - k_1))-a_0*k_0/k_1}
for (t in 1:(length(a)-1)) {
f3 <- function(k_1) {f2(a[t],k[t],k_1)}
k[t+1] <- uniroot(f3, c(0,K_bar))$root
}
q <- a*0.0 + q_star
for (t in (length(a)-1):1) {
q[t] = a[t]*k[t]/k[t+1] + q[t+1]/R
}
b <- q * k / R
k_prime <- k_bar - k
k_prime <- K_bar - k
output <- (a + k) + m*G(k_prime)
output
plot(output)
plot(y, type = "l", col = "red", lty=2)
k_prime_star <- K_bar - k_star
y_star <-  (a + k_star) + m*G(k_prime_star)
plot(y, type ="l", col = "red", lty=2)
abline(h=y_star)
y_star
y_star <-  (a_ss + k_star) + m*G(k_prime_star)
plot(a, type="l", col = "red", lty=2)
plot(k, type="l", col = "red", lty=2)
abline(h=k_star)
plot(q, type="l", col = "red", lty=2)
abline(h=q_star)
plot(b, type="l", col = "red", lty=2)
abline(h=b_star)
plot(y, type ="l", col = "red", lty=2)
plot(y, type ="l", col = "red", lty=2)
abline(h=y_star)
y <- (a + k) + m*G(k_prime)
y_star <-  (a_ss + k_star) + m*G(k_prime_star)
plot(y, type ="l", col = "red", lty=2)
abline(h=y_star)
plot(y/y_star * 100, type ="l", col = "red", lty=2)
lines(a * 100)
y_star
y
a
plot(a *100, type ="l", col = "red", lty=2)
lines(y/y_star * 100)
x <- c(4363069 ,4883604, 4760326, 10405811 + 102661692)
x/sum(x)
x/sum(x)*100
library(tidyverse)
library(haven)
library("tidyverse")
install.packages("tidyverse")
library("tidyverse")
install.packages("haven")
library(haven)
library(readxl)
pwd("/users/vonhafften/Desktop/July 2025/")
library(fredr) # install.packages("fredr") # run once if not installed
library(tidyverse)
library(mFilter)
cpi_pull      <- fredr(series_id = "CPIAUCSL",
observation_start = start_date,
frequency = "a",
aggregation_method = "avg") %>%       # CPI
transmute(date,cpi = value)
# Download data
start_date =  ymd("1978-01-01")
real_gdp_pull       <- fredr(series_id = "GDPC1",
observation_start = start_date,
frequency = "a",
aggregation_method = "avg") %>%          # Real GDP (Chained 2017 Dollars)
transmute(date,real_gdp = value)
# Set your FRED API key (get one free from https://fred.stlouisfed.org/docs/api/api_key.html)
fredr_set_key("5ad95699d030ae12195ab130b6d50dcb")
# Download data
start_date =  ymd("1978-01-01")
real_gdp_pull       <- fredr(series_id = "GDPC1",
observation_start = start_date,
frequency = "a",
aggregation_method = "avg") %>%          # Real GDP (Chained 2017 Dollars)
transmute(date,real_gdp = value)
cpi_pull      <- fredr(series_id = "CPIAUCSL",
observation_start = start_date,
frequency = "a",
aggregation_method = "avg") %>%       # CPI
transmute(date,cpi = value)
new_car_cpi_pull    <- fredr(series_id = "CUSR0000SETA01",
observation_start = start_date,
frequency = "a",
aggregation_method = "avg") %>% # CPI: New vehicles
transmute(date,new_car_cpi = value)
used_car_cpi_pull   <- fredr(series_id = "CUSR0000SETA02",
observation_start = start_date,
frequency = "a",
aggregation_method = "avg") %>% # CPI: Used vehicles
transmute(date,used_car_cpi = value)
used_car_cpi_pull
pull_df <- real_gdp_pull %>%
inner_join(cpi_pull, by="date")%>%
inner_join(new_car_cpi_pull, by="date")%>%
inner_join(used_car_cpi_pull, by="date") %>%
mutate(new_car_cpi = new_car_cpi/cpi,
used_car_cpi = used_car_cpi/cpi,
used_car_cpi_2 = used_car_cpi/new_car_cpi) %>%
select(-cpi) %>%
arrange(date)
real_gdp_hp       <- hpfilter(pull_df$real_gdp,freq = lambda)
# Choose frequency-dependent lambda for HP filter:
lambda <- 6.25
# Apply HP filter to each series
real_gdp_hp       <- hpfilter(pull_df$real_gdp,freq = lambda)
new_car_price_hp  <- hpfilter(pull_df$new_car_cpi,freq = lambda)
used_car_price_hp <- hpfilter(pull_df$used_car_cpi,freq = lambda)
used_car_price_2_hp <- hpfilter(pull_df$used_car_cpi_2,freq = lambda)
cycle_df <- tibble(Date = pull_df$date,
real_gdp = real_gdp_hp$cycle,
new_car_cpi = new_car_price_hp$cycle,
used_car_cpi = used_car_price_hp$cycle,
used_car_cpi_2 = used_car_price_2_hp$cycle)
# numbers to highlight in intro
cor(cycle_df$used_car_cpi,cycle_df$real_gdp,use="complete.obs")/cor(cycle_df$new_car_cpi,cycle_df$real_gdp,use="complete.obs")
cycle_df
# Choose frequency-dependent lambda for HP filter:
lambda <- 6.25
# Apply HP filter to each series
real_gdp_hp       <- hpfilter(pull_df$real_gdp,freq = lambda)
new_car_price_hp  <- hpfilter(pull_df$new_car_cpi,freq = lambda)
used_car_price_hp <- hpfilter(pull_df$used_car_cpi,freq = lambda)
used_car_price_2_hp <- hpfilter(pull_df$used_car_cpi_2,freq = lambda)
cycle_df <- tibble(Date = pull_df$date,
real_gdp = real_gdp_hp$cycle,
new_car_cpi = new_car_price_hp$cycle,
used_car_cpi = used_car_price_hp$cycle,
used_car_cpi_2 = used_car_price_2_hp$cycle)
cycle_df
pull_df <- real_gdp_pull %>%
inner_join(cpi_pull, by="date")%>%
inner_join(new_car_cpi_pull, by="date")%>%
inner_join(used_car_cpi_pull, by="date") %>%
mutate(new_car_cpi = new_car_cpi/cpi,
used_car_cpi = used_car_cpi/cpi,
used_car_cpi_2 = used_car_cpi/new_car_cpi) %>%
select(-cpi) %>%
arrange(date)
pull_df
# Choose frequency-dependent lambda for HP filter:
lambda <- 6.25
# Apply HP filter to each series
real_gdp_hp       <- hpfilter(pull_df$real_gdp,freq = lambda)
new_car_price_hp  <- hpfilter(pull_df$new_car_cpi,freq = lambda)
used_car_price_hp <- hpfilter(pull_df$used_car_cpi,freq = lambda)
used_car_price_2_hp <- hpfilter(pull_df$used_car_cpi_2,freq = lambda)
cycle_df <- tibble(Date = pull_df$date,
real_gdp = real_gdp_hp$cycle,
new_car_cpi = new_car_price_hp$cycle,
used_car_cpi = used_car_price_hp$cycle,
used_car_cpi_2 = used_car_price_2_hp$cycle)
real_gdp_hp
new_car_price_hp    <- hpfilter(pull_df$new_car_cpi,    freq = lambda)
used_car_price_hp   <- hpfilter(pull_df$used_car_cpi,   freq = lambda)
used_car_price_2_hp <- hpfilter(pull_df$used_car_cpi_2, freq = lambda)
cycle_df <- tibble(Date = pull_df$date,
real_gdp = real_gdp_hp$cycle,
new_car_cpi = new_car_price_hp$cycle,
used_car_cpi = used_car_price_hp$cycle,
used_car_cpi_2 = used_car_price_2_hp$cycle)
used_car_price_2_hp
used_car_price_hp
?used_car_price_hp
?used_car_price_hp
?hpfilter
start_date =  ymd("1978-01-01")
end_date =  ymd("2025-01-01")
real_gdp_pull       <- fredr(series_id = "GDPC1",
observation_start = start_date,
observation_end = end_date,
frequency = "a",
aggregation_method = "avg") %>%          # Real GDP (Chained 2017 Dollars)
transmute(date,real_gdp = value)
real_gdp_pull
cpi_pull      <- fredr(series_id = "CPIAUCSL",
observation_start = start_date,
observation_end = end_date,
frequency = "a",
aggregation_method = "avg") %>%       # CPI
transmute(date,cpi = value)
new_car_cpi_pull    <- fredr(series_id = "CUSR0000SETA01",
observation_start = start_date,
observation_end = end_date,
frequency = "a",
aggregation_method = "avg") %>% # CPI: New vehicles
transmute(date,new_car_cpi = value)
used_car_cpi_pull   <- fredr(series_id = "CUSR0000SETA02",
observation_start = start_date,
observation_end = end_date,
frequency = "a",
aggregation_method = "avg") %>% # CPI: Used vehicles
transmute(date,used_car_cpi = value)
pull_df <- real_gdp_pull %>%
inner_join(cpi_pull, by="date")%>%
inner_join(new_car_cpi_pull, by="date")%>%
inner_join(used_car_cpi_pull, by="date") %>%
mutate(new_car_cpi = new_car_cpi/cpi,
used_car_cpi = used_car_cpi/cpi,
used_car_cpi_2 = used_car_cpi/new_car_cpi) %>%
select(-cpi) %>%
arrange(date)
# Choose frequency-dependent lambda for HP filter:
lambda <- 6.25
# Apply HP filter to each series
real_gdp_hp         <- hpfilter(pull_df$real_gdp,       freq = lambda)
real_gdp_hp
pull_df <- real_gdp_pull %>%
inner_join(cpi_pull, by="date")%>%
inner_join(new_car_cpi_pull, by="date")%>%
inner_join(used_car_cpi_pull, by="date") %>%
mutate(new_car_cpi = new_car_cpi/cpi,
used_car_cpi = used_car_cpi/cpi,
used_car_cpi_2 = used_car_cpi/new_car_cpi) %>%
select(-cpi) %>%
arrange(date)
pull_df
pull_df <- real_gdp_pull %>%
inner_join(cpi_pull, by="date")%>%
inner_join(new_car_cpi_pull, by="date")%>%
inner_join(used_car_cpi_pull, by="date") %>%
mutate(new_car_cpi = new_car_cpi/cpi,
used_car_cpi = used_car_cpi/cpi,
used_car_cpi_2 = used_car_cpi/new_car_cpi) %>%
select(-cpi) %>%
arrange(-date)
View(pull_df)
# Download data
start_date =  ymd("1978-01-01")
end_date =  ymd("2024-12-31")
real_gdp_pull       <- fredr(series_id = "GDPC1",
observation_start = start_date,
observation_end = end_date,
frequency = "a",
aggregation_method = "avg") %>%          # Real GDP (Chained 2017 Dollars)
transmute(date,real_gdp = value)
real_gdp_pull
View(real_gdp_hp)
View(real_gdp_pull)
real_gdp_pull       <- fredr(series_id = "GDPC1",
observation_start = start_date,
observation_end = end_date,
frequency = "a",
aggregation_method = "avg") %>%          # Real GDP (Chained 2017 Dollars)
transmute(date,real_gdp = value)
cpi_pull      <- fredr(series_id = "CPIAUCSL",
observation_start = start_date,
observation_end = end_date,
frequency = "a",
aggregation_method = "avg") %>%       # CPI
transmute(date,cpi = value)
new_car_cpi_pull    <- fredr(series_id = "CUSR0000SETA01",
observation_start = start_date,
observation_end = end_date,
frequency = "a",
aggregation_method = "avg") %>% # CPI: New vehicles
transmute(date,new_car_cpi = value)
used_car_cpi_pull   <- fredr(series_id = "CUSR0000SETA02",
observation_start = start_date,
observation_end = end_date,
frequency = "a",
aggregation_method = "avg") %>% # CPI: Used vehicles
transmute(date,used_car_cpi = value)
pull_df <- real_gdp_pull %>%
inner_join(cpi_pull, by="date")%>%
inner_join(new_car_cpi_pull, by="date")%>%
inner_join(used_car_cpi_pull, by="date") %>%
mutate(new_car_cpi = new_car_cpi/cpi,
used_car_cpi = used_car_cpi/cpi,
used_car_cpi_2 = used_car_cpi/new_car_cpi) %>%
select(-cpi) %>%
arrange(date)
# Choose frequency-dependent lambda for HP filter:
lambda <- 6.25
# Apply HP filter to each series
real_gdp_hp         <- hpfilter(pull_df$real_gdp,       freq = lambda)
new_car_price_hp    <- hpfilter(pull_df$new_car_cpi,    freq = lambda)
used_car_price_hp   <- hpfilter(pull_df$used_car_cpi,   freq = lambda)
used_car_price_2_hp <- hpfilter(pull_df$used_car_cpi_2, freq = lambda)
cycle_df <- tibble(Date = pull_df$date,
real_gdp = real_gdp_hp$cycle,
new_car_cpi = new_car_price_hp$cycle,
used_car_cpi = used_car_price_hp$cycle,
used_car_cpi_2 = used_car_price_2_hp$cycle)
cycle_df
# numbers to highlight in intro
cor(cycle_df$used_car_cpi,cycle_df$real_gdp,use="complete.obs")/cor(cycle_df$new_car_cpi,cycle_df$real_gdp,use="complete.obs")
sd(cycle_df$used_car_cpi,na.rm=TRUE)/sd(cycle_df$new_car_cpi,na.rm=TRUE)
sd(cycle_df$used_car_cpi,na.rm=TRUE)
cor(cycle_df$used_car_cpi,cycle_df$real_gdp,use="complete.obs")
sd(cycle_df$used_car_cpi,na.rm=TRUE)
acf(cycle_df$used_car_cpi,plot = FALSE, lag.max = 3)
sd(cycle_df$used_car_cpi_2,na.rm=TRUE)
cor(cycle_df$used_car_cpi_2,cycle_df$real_gdp,use="complete.obs")
acf(cycle_df$used_car_cpi_2,plot = FALSE, lag.max = 3)
setwd("/Users/vonhafften/Documents/vonhafften.github.io/")
library(rmarkdown)
render('index.Rmd', output_format = "html_document")
render('research.Rmd', output_format = "html_document")
render('teaching.Rmd', output_format = "html_document")
render('teaching/econ714b_pastexamquestions.Rmd', output_format = c("html_document", "pdf_document"))
